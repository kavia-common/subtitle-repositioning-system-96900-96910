{"is_source_file": true, "format": "Python", "description": "This source file implements core logic for repositioning subtitles to avoid burnt-in text overlays, supporting formats like SRT, ASS/SSA, and VTT. It includes heuristics for determining whether subtitles should be placed on the top or bottom of the screen based on image analysis simulation, and provides functions to parse, manipulate, and reformat subtitle files accordingly.", "external_files": [], "external_methods": ["reposition_subtitles7.py (original script from which logic is adapted)"], "published": ["decide_subtitle_placement", "process_subtitle"], "classes": [{"name": "Timecode", "description": "Represents a timestamp in hours, minutes, seconds, and milliseconds, with conversion methods."}, {"name": "SRTItem", "description": "Represents a subtitle item in SRT format with index, start/end timecodes, and text content."}], "methods": [{"name": "List[SRTItem] parse_srt(content: str)", "description": "Parses SRT subtitle content into a list of SRTItem objects.", "scope": "", "scopeKind": ""}, {"name": "str format_srt(items: List[SRTItem])", "description": "Converts a list of SRTItem objects back into SRT formatted text.", "scope": "", "scopeKind": ""}, {"name": "str move_ass_line_to_top(text: str)", "description": "Prepends ASS override tags to move dialogue to the top of the screen.", "scope": "", "scopeKind": ""}, {"name": "str move_ass_line_to_bottom(text: str)", "description": "Prepares ASS dialogue lines to appear at the bottom.", "scope": "", "scopeKind": ""}, {"name": "str reposition_ass_ssa(content: str, place_top: bool)", "description": "Modifies ASS/SSA subtitle content to set dialogue position to top or bottom.", "scope": "", "scopeKind": ""}, {"name": "str reposition_vtt(content: str, place_top: bool)", "description": "Adjusts WebVTT subtitle content to position cues at top or bottom.", "scope": "", "scopeKind": ""}, {"name": "List[Tuple[str,float]] detect_burnin_regions(video_path: str)", "description": "Simulates detection of burnt-in subtitle regions to inform placement heuristics.", "scope": "", "scopeKind": ""}, {"name": "bool decide_subtitle_placement(video_path: str)", "description": "Decides whether to place subtitles at top or bottom based on detected burn-in regions.", "scope": "", "scopeKind": ""}, {"name": "str process_subtitle(video_path: str, subtitle_path: str)", "description": "Main entry point to process a subtitle file for repositioning based on heuristics and format.", "scope": "", "scopeKind": ""}, {"name": "str __str__(self)", "scope": "Timecode", "scopeKind": "class", "description": "unavailable"}, {"name": "Timecode _parse_timecode_fragment(fragment: str)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "\"Timecode\" from_ms(ms: int)", "scope": "Timecode", "scopeKind": "class", "description": "unavailable"}, {"name": "List[str] reposition_vtt_lines(lines: List[str], place_top: bool)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "int to_ms(self)", "scope": "Timecode", "scopeKind": "class", "description": "unavailable"}], "calls": ["parse_srt", "format_srt", "reposition_ass_ssa", "reposition_vtt", "detect_burnin_regions", "decide_subtitle_placement"], "search-terms": ["subtitle repositioning", "burn-in detection", "format conversion", "ASS override tags", "WebVTT positioning", "heuristics", "subtitle file processing", "top-bottom placement", "srt parser", "subtitle adaptation"], "state": 2, "file_id": 5, "knowledge_revision": 17, "git_revision": "e8ff374ccea8fe9adfe33b73bbf5d95e6e05bc58", "revision_history": [{"11": ""}, {"14": "bc3e1227b9b97d15bd7553afdb4a3fa17595a5bb"}, {"17": "e8ff374ccea8fe9adfe33b73bbf5d95e6e05bc58"}], "ctags": [{"_type": "tag", "name": "ASS_EVENT_RE", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^ASS_EVENT_RE = re.compile(r\"^(Dialogue|Comment):\\\\s*(?P<rest>.*)$\", re.IGNORECASE)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "ASS_FIELDS_SPLIT", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^ASS_FIELDS_SPLIT = re.compile(r\"(?<!\\\\\\\\),\")$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "SRTItem", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^class SRTItem:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SRT_TIME_RE", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^SRT_TIME_RE = re.compile($/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "Timecode", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^class Timecode:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__str__", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^    def __str__(self) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(self)", "scope": "Timecode", "scopeKind": "class"}, {"_type": "tag", "name": "_parse_timecode_fragment", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def _parse_timecode_fragment(fragment: str) -> Timecode:$/", "language": "Python", "typeref": "typename:Timecode", "kind": "function", "signature": "(fragment: str)"}, {"_type": "tag", "name": "decide_subtitle_placement", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def decide_subtitle_placement(video_path: str) -> bool:$/", "language": "Python", "typeref": "typename:bool", "kind": "function", "signature": "(video_path: str)"}, {"_type": "tag", "name": "detect_burnin_regions", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def detect_burnin_regions(video_path: str) -> List[Tuple[str, float]]:$/", "language": "Python", "typeref": "typename:List[Tuple[str,float]]", "kind": "function", "signature": "(video_path: str)"}, {"_type": "tag", "name": "format_srt", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def format_srt(items: List[SRTItem]) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(items: List[SRTItem])"}, {"_type": "tag", "name": "from_ms", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^    def from_ms(ms: int) -> \"Timecode\":$/", "language": "Python", "typeref": "typename:\"Timecode\"", "kind": "member", "signature": "(ms: int)", "scope": "Timecode", "scopeKind": "class"}, {"_type": "tag", "name": "move_ass_line_to_bottom", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def move_ass_line_to_bottom(text: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "move_ass_line_to_top", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def move_ass_line_to_top(text: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(text: str)"}, {"_type": "tag", "name": "parse_srt", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def parse_srt(content: str) -> List[SRTItem]:$/", "language": "Python", "typeref": "typename:List[SRTItem]", "kind": "function", "signature": "(content: str)"}, {"_type": "tag", "name": "process_subtitle", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def process_subtitle(video_path: str, subtitle_path: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(video_path: str, subtitle_path: str)"}, {"_type": "tag", "name": "reposition_ass_ssa", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def reposition_ass_ssa(content: str, place_top: bool) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(content: str, place_top: bool)"}, {"_type": "tag", "name": "reposition_vtt", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def reposition_vtt(content: str, place_top: bool) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(content: str, place_top: bool)"}, {"_type": "tag", "name": "reposition_vtt_lines", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^def reposition_vtt_lines(lines: List[str], place_top: bool) -> List[str]:$/", "language": "Python", "typeref": "typename:List[str]", "kind": "function", "signature": "(lines: List[str], place_top: bool)"}, {"_type": "tag", "name": "to_ms", "path": "/home/kavia/workspace/code-generation/subtitle-repositioning-system-96900-96910/subtitle_backend/src/api/reposition_core.py", "pattern": "/^    def to_ms(self) -> int:$/", "language": "Python", "typeref": "typename:int", "kind": "member", "signature": "(self)", "scope": "Timecode", "scopeKind": "class"}], "hash": "b127282702d34658e37867339e238d21", "format-version": 4, "code-base-name": "subtitle_backend", "filename": "subtitle_backend/src/api/reposition_core.py", "fields": [{"name": "ASS_EVENT_RE = re.compile(r\"^(Dialogue|Comment):\\\\s*(?P<rest>.*)$\", re.IGNORECASE)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "ASS_FIELDS_SPLIT = re.compile(r\"(?<!\\\\\\\\),\")", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "SRT_TIME_RE = re.compile(", "scope": "", "scopeKind": "", "description": "unavailable"}]}